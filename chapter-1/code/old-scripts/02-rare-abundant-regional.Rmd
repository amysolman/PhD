---
title: "02-rare-abundant-regional"
author: "Amy Solman"
date: "05/08/2021"
output: html_document
---
In this script I'm going to divide my cryoconite data into subcommunities based on their regional abundance.
Following Liu et al. (2015), Li et al., (2021)

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Clear workspace and load packages
```{r}
rm(list=ls())
graphics.off()

library(phyloseq)
library(dplyr) 
library(plyr)
#install.packages("BiodiversityR") #for rank abundance plot
#library(BiodiversityR)
library(ggplot2)
```

Load data 
```{r}
#load phyloseq object
ps_pro <- readRDS("../results/16S/phylo-objects/16S-phyloseq-object-rarefied-decontam.rds") 
ps_euk <- readRDS("../results/18S/phylo-objects/18S-phyloseq-object-rarefied.rds") 
```

Abundance cut-offs
```{r}
#These are the cut-offs from the literature
# rare_range <- c(0.001, 0.00001, 0.0001, 0.0001, 0.00001, 0.00001, 0.0005, 0.001, 0.0001, 0.001, 0.00001)
# abundant_range <- c(0.01, 0.0005, 0.0001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.001, 0.01, 0.0005)

#I've made my mid-range cut-off, low = half the mid, high = twice the mid
# rare_mid <- count(rare_range)[order(-count(rare_range)$freq),][1][2,]
# rare_low <- rare_mid/2
# rare_high <- rare_mid*2
# abun_mid <- count(abundant_range)[order(-count(abundant_range)$freq),][1][1,]
# abun_low <- abun_mid/2
# abun_high <- abun_mid*2

rare_mid <- 0.0001
rare_low <- rare_mid/2
rare_high <- rare_mid*2
abun_mid <- 0.001
abun_low <- abun_mid/2
abun_high <- abun_mid*2

cutoffs.df = data.frame(Scenario=c(1,2,3,4,5,6,7,8,9), Rare=c(rare_low, rare_mid, rare_high, rare_low, rare_mid, rare_high, rare_low, rare_mid, rare_high), Abundant=c(abun_low, abun_low, abun_low, abun_mid, abun_mid, abun_mid, abun_high, abun_high, abun_high))

#Testing area
# x[order(-x$freq),]
# count(abundant_range)[order(-count(abundant_range)$freq),][1][1,]

```

Plot mean relative abundance of each ASV (x axis) by number of ASVs (y axis)
```{r}
#Function testing area
# phylo <- ps_pro
# kingdom = "16S"

abundance_frequences_cutoffs <- function(phylo, kingdom){
  
regions <- unique(data.frame(sample_data(phylo))$Region)

#create empty dataframe
new_df <- data.frame(x=as.numeric(), freq=as.numeric(), Region=as.character())

#loop through the regions to build our data frame for plotting

for (i in 1:length(regions)){
  
#create logical vector of samples that are for a specific region
log_vec <- data.frame(sample_data(phylo))$Region == regions[i]

#prune data using logical vector
sub_data <- prune_samples(log_vec, phylo)
  
#transform to relative abundance
rel = transform_sample_counts(sub_data, function(x) x / sum(x) )

#remove rows with zero relative abundance
rel = filter_taxa(rel, function(x) mean(x) > 0, TRUE)

#get count table
rel_asv <- data.frame(otu_table(rel))

#find column means
mean_rel_abun <- rowMeans(rel_asv)

#count the mean relative abundances
df <- count(mean_rel_abun)
df$Region <- regions[i]
new_df <- rbind(new_df, df)
}

p <- ggplot(new_df, aes(x=x, y=freq, color=Region)) + 
  geom_point()+
  geom_vline(xintercept = rare_low, linetype="dotted", 
                color = "blue", size=0.5)+
    geom_vline(xintercept = rare_mid, linetype="solid", 
                color = "blue", size=0.5)+
    geom_vline(xintercept = rare_high, linetype="dotted", 
                color = "blue", size=0.5)+
  geom_vline(xintercept = abun_low, linetype="dotted", 
                color = "red", size=0.5)+
    geom_vline(xintercept = abun_mid, linetype="solid", 
                color = "red", size=0.5)+
    geom_vline(xintercept = abun_high, linetype="dotted", 
                color = "red", size=0.5)+
  scale_x_continuous(trans='log10')+
  xlab("Log10 Mean Relative Abundance")+
  ylab("Frequency")+
  ggtitle(paste0("Frequency of Mean Relative Abundance of ", kingdom, " ASVs"))+
  theme_bw()

    pdf(paste0("../results/", kingdom, "/graphs/abundance-class/", kingdom, "-abundance-frequency-cutoffs-regional.pdf"))
    print(p)
    dev.off()
    
    
  # #export list of ASVs with classifications
  # #list of ASVs with mean relative abundance
  # df2 <- data.frame(ASV=row.names(rel_asv), RelAbun=mean_rel_abun)
  # 
  # return(df2)
}

```

Function to merge phyloseq objects of same abundance class
```{r}
#Function testing area
# phylo1 = ps1_rel_rare
# phylo2 = ps2_rel_rare
# phylo3 = ps3_rel_rare
# phylo4 = ps4_rel_rare
# phylo5 = ps5_rel_rare
# phylo6 = ps_pro
  
# combine_phyloseq <- function(phylo1, phylo2, phylo3, phylo4, phylo5, phylo6){
# 
# #get our mcmurdo dry valleys abundance count table
# abun_count1 <- data.frame(otu_table(phylo1), check.names = FALSE)
# names(abun_count1) <- sample_data(phylo1)$SampleID
# abun_count1$ASV <- row.names(abun_count1)
# 
# #get our queen maud land abundance count table
# abun_count2 <- data.frame(otu_table(phylo2), check.names = FALSE)
# names(abun_count2) <- sample_data(phylo2)$SampleID
# abun_count2$ASV <- row.names(abun_count2)
# 
# #get our svalbard abundance count table
# abun_count3 <- data.frame(otu_table(phylo3), check.names = FALSE)
# names(abun_count3) <- sample_data(phylo3)$SampleID
# abun_count3$ASV <- row.names(abun_count3)
# 
# #get our sweden abundance count table
# abun_count4 <- data.frame(otu_table(phylo4), check.names = FALSE)
# names(abun_count4) <- sample_data(phylo4)$SampleID
# abun_count4$ASV <- row.names(abun_count4)
# 
# #get our greenland abundance count table
# abun_count5 <- data.frame(otu_table(phylo5), check.names = FALSE)
# names(abun_count5) <- sample_data(phylo5)$SampleID
# abun_count5$ASV <- row.names(abun_count5)
# 
# x <- dplyr::bind_rows(abun_count1, abun_count2, abun_count3, abun_count4, abun_count5)
# x[is.na(x)] <- 0
# #aggregate rows by ASV ID
# y <- ddply(x,"ASV",numcolwise(sum))
# row.names(y) <- y$ASV
# y <- subset(y, select=-c(ASV))
# 
# my_subset <- subset(otu_table(phylo6), rownames(otu_table(phylo6)) %in% row.names(y))
# new_physeq <- merge_phyloseq(my_subset, tax_table(phylo6), sample_data(phylo6), phy_tree(phylo6))
# return(new_physeq)
# }
```

Function to merge phyloseq objects of same abundance class
```{r}
combine_two_phyloseq <- function(phylo1, phylo2, phylo3){
  #get our arctic abundance count table
abun_count1 <- data.frame(otu_table(phylo1), check.names = FALSE)
names(abun_count1) <- sample_data(phylo1)$SampleID
abun_count1$ASV <- row.names(abun_count1)
#get our antarctic abundance count table
abun_count2 <- data.frame(otu_table(phylo2), check.names = FALSE)
names(abun_count2) <- sample_data(phylo2)$SampleID
abun_count2$ASV <- row.names(abun_count2)
x <- dplyr::bind_rows(abun_count1, abun_count2)
x[is.na(x)] <- 0
#aggregate rows by ASV ID
y <- ddply(x,"ASV",numcolwise(sum))
row.names(y) <- y$ASV
y <- subset(y, select=-c(ASV))

my_subset <- subset(otu_table(phylo3), rownames(otu_table(phylo3)) %in% row.names(y))
new_physeq <- merge_phyloseq(my_subset, tax_table(phylo3), sample_data(phylo3), phy_tree(phylo3))
return(new_physeq)
}
```

Function for getting phyloseq objects by abundance under one scenario
```{r}
#Function testing area
# out <- get_my_phyloseq_objects(ps_pro, 0.00005, 0.0005)
# phylo = ps_euk
# rare = rare_mid
# abundant= abun_mid
# subset_area <- "Region"
# mean_abun <- rowMeans(data.frame(otu_table(ps1_rel)))
# mean_abun_rare <- mean_abun[mean_abun <= 0.00005]


get_my_phyloseq_objects <- function(phylo, rare, abundant, subset_area){
  
  #get a list of subset areas
  areas <- unique(data.frame(sample_data(phylo))[,subset_area])
  
  for (i in 1:length(areas)){
  
  #create logical vector of samples that are for a specific area
  log_vec <- data.frame(sample_data(phylo))[,subset_area] == areas[i]
  
  #prune data using logical vector
  sub_data <- prune_samples(log_vec, phylo)

  #get relative abundances
  ps_rel  = transform_sample_counts(sub_data, function(x) x / sum(x) )
  
  #remove ASVs with zero relative abundance
  ps_rel_no_zero = filter_taxa(ps_rel, function(x) sum(x) > 0, TRUE)
  
  #filter taxa by mean relative abundance
  ps_rel_rare1 = filter_taxa(ps_rel_no_zero, function(x) mean(x) <= rare, TRUE)
  ps_rel_abundant1 = filter_taxa(ps_rel_no_zero, function(x) mean(x) >= abundant, TRUE)
  ps_rel_intermediate1 = filter_taxa(ps_rel_no_zero, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  
  #on the first area change the names of the phylo seq objects to 2
  if (i == 1){
    ps_rel_rare2 = ps_rel_rare1
    ps_rel_abundant2 = ps_rel_abundant1
    ps_rel_intermediate2 = ps_rel_intermediate1

  } else {
    
    #if we're not on the first area then merge with the previous area
    ps_rel_rare2 = combine_two_phyloseq(ps_rel_rare1, ps_rel_rare2, phylo)
    ps_rel_abundant2 = combine_two_phyloseq(ps_rel_abundant1, ps_rel_abundant2, phylo)
    ps_rel_intermediate2 = combine_two_phyloseq(ps_rel_intermediate1, ps_rel_intermediate2, phylo)
    
    # #then change the name of the phyloseq objects
    # ps_rel_rare2 = ps_rel_rare1
    # ps_rel_abundant2 = ps_rel_abundant1
    # ps_rel_intermediate2 = ps_rel_intermediate1
    
  }

}
  
  
  # #subset phyloseq object by region
  # ps1 <- subset_samples(phylo, Region == "McMurdo_Dry_Valleys")
  # 
  # #get relative abundances
  # ps1_rel  = transform_sample_counts(ps1, function(x) x / sum(x) )
  # 
  # #remove ASVs with zero relative abundance
  # ps1_rel = filter_taxa(ps1_rel, function(x) sum(x) > 0, TRUE)
  # 
  # #filter taxa by mean relative abundance
  # ps1_rel_rare = filter_taxa(ps1_rel, function(x) mean(x) <= rare, TRUE)
  # ps1_rel_abundant = filter_taxa(ps1_rel, function(x) mean(x) >= abundant, TRUE)
  # ps1_rel_intermediate = filter_taxa(ps1_rel, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  # 
  # #subset phyloseq object by region
  # ps2 <- subset_samples(phylo, Region == "Queen_Maud_Land")
  # 
  # #get relative abundances
  # ps2_rel  = transform_sample_counts(ps2, function(x) x / sum(x) )
  # 
  # #remove ASVs with zero relative abundance
  # ps2_rel = filter_taxa(ps2_rel, function(x) sum(x) > 0, TRUE)
  # 
  # #filter taxa by mean relative abundance
  # ps2_rel_rare = filter_taxa(ps2_rel, function(x) mean(x) <= rare, TRUE)
  # ps2_rel_abundant = filter_taxa(ps2_rel, function(x) mean(x) >= abundant, TRUE)
  # ps2_rel_intermediate = filter_taxa(ps2_rel, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  # 
  # #subset phyloseq object by region
  # ps3 <- subset_samples(phylo, Region == "Svalbard")
  # 
  # #get relative abundances
  # ps3_rel  = transform_sample_counts(ps3, function(x) x / sum(x) )
  # 
  # #remove ASVs with zero relative abundance
  # ps3_rel = filter_taxa(ps3_rel, function(x) sum(x) > 0, TRUE)
  # 
  # #filter taxa by mean relative abundance
  # ps3_rel_rare = filter_taxa(ps3_rel, function(x) mean(x) <= rare, TRUE)
  # ps3_rel_abundant = filter_taxa(ps3_rel, function(x) mean(x) >= abundant, TRUE)
  # ps3_rel_intermediate = filter_taxa(ps3_rel, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  # 
  # #subset phyloseq object by region
  # ps4 <- subset_samples(phylo, Region == "Sweden")
  # 
  # #get relative abundances
  # ps4_rel  = transform_sample_counts(ps4, function(x) x / sum(x) )
  # 
  # #remove ASVs with zero relative abundance
  # ps4_rel = filter_taxa(ps4_rel, function(x) sum(x) > 0, TRUE)
  # 
  # #filter taxa by mean relative abundance
  # ps4_rel_rare = filter_taxa(ps4_rel, function(x) mean(x) <= rare, TRUE)
  # ps4_rel_abundant = filter_taxa(ps4_rel, function(x) mean(x) >= abundant, TRUE)
  # ps4_rel_intermediate = filter_taxa(ps4_rel, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  # 
  # #subset phyloseq object by region
  # ps5 <- subset_samples(phylo, Region == "Greenland")
  # 
  # #get relative abundances
  # ps5_rel  = transform_sample_counts(ps5, function(x) x / sum(x) )
  # 
  # #remove ASVs with zero relative abundance
  # ps5_rel = filter_taxa(ps5_rel, function(x) sum(x) > 0, TRUE)
  # 
  # #filter taxa by mean relative abundance
  # ps5_rel_rare = filter_taxa(ps5_rel, function(x) mean(x) <= rare, TRUE)
  # ps5_rel_abundant = filter_taxa(ps5_rel, function(x) mean(x) >= abundant, TRUE)
  # ps5_rel_intermediate = filter_taxa(ps5_rel, function(x) mean(x) > rare && mean(x) < abundant, TRUE)
  # 
  # #merge regional phyloseq objects under this scenario 
  # phylo.rare <- combine_phyloseq(ps1_rel_rare, ps2_rel_rare, ps3_rel_rare, ps4_rel_rare, ps5_rel_rare, phylo)
  # phylo.abundant <- combine_phyloseq(ps1_rel_abundant, ps2_rel_abundant, ps3_rel_abundant,  ps4_rel_abundant,  ps5_rel_abundant, phylo)
  # phylo.intermediate <- combine_phyloseq(ps1_rel_intermediate, ps2_rel_intermediate, ps3_rel_intermediate, ps3_rel_intermediate, ps3_rel_intermediate, phylo)
  
  #save phyloseq object to list ready to be returned
  list<-list()
  list[[1]] <- ps_rel_rare2
  list[[2]] <- ps_rel_abundant2
  list[[3]] <- ps_rel_intermediate2
  
  return(list)
  
}
```

Function: Get my phyloseq objects under different scenarios
```{r}
get_multi_lists <- function(phylo, df, subset_area){
  res <- list()
for (i in 1:nrow(df)){
  rare = df$Rare[i]
  abundant= df$Abundant[i]
  x <- get_my_phyloseq_objects(phylo, rare, abundant, subset_area)
  res[[i]] <- x
}
  return(res)
}

#Function testing area
#pro_multi_list_res <- get_multi_lists(ps_pro, cutoffs.df)
# phylo = ps_euk
# df = cutoffs.df
```

Now create the phyloseq objects ready to export!
```{r}
#16S
pro_res <- abundance_frequences_cutoffs(ps_pro, "16S")
pro_multi_list_res <- get_multi_lists(ps_pro, cutoffs.df, "Region")

#18S
euk_res <- abundance_frequences_cutoffs(ps_euk, "18S")
euk_multi_list_res <- get_multi_lists(ps_euk, cutoffs.df, "Region")
```

Export phyloseq objects
```{r}
#Prokaryotic rare ASVs scenario one
saveRDS(pro_multi_list_res[[1]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-one.rds")
#Prokaryotic abundant ASVs scenario one
saveRDS(pro_multi_list_res[[1]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-one.rds")
#Prokaryotic intermediate ASVs scenario one
saveRDS(pro_multi_list_res[[1]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-one.rds")

#Prokaryotic rare ASVs scenario two
saveRDS(pro_multi_list_res[[2]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-two.rds")
#Prokaryotic abundant ASVs scenario two
saveRDS(pro_multi_list_res[[2]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-two.rds")
#Prokaryotic intermediate ASVs scenario two
saveRDS(pro_multi_list_res[[2]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-two.rds")

#Prokaryotic rare ASVs scenario three
saveRDS(pro_multi_list_res[[3]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-three.rds")
#Prokaryotic abundant ASVs scenario three
saveRDS(pro_multi_list_res[[3]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-three.rds")
#Prokaryotic intermediate ASVs scenario three
saveRDS(pro_multi_list_res[[3]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-three.rds")

#Prokaryotic rare ASVs scenario four
saveRDS(pro_multi_list_res[[4]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-four.rds")
#Prokaryotic abundant ASVs scenario four
saveRDS(pro_multi_list_res[[4]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-four.rds")
#Prokaryotic intermediate ASVs scenario four
saveRDS(pro_multi_list_res[[4]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-four.rds")

#Prokaryotic rare ASVs scenario five
saveRDS(pro_multi_list_res[[5]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-five.rds")
#Prokaryotic abundant ASVs scenario five
saveRDS(pro_multi_list_res[[5]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-five.rds")
#Prokaryotic intermediate ASVs scenario five
saveRDS(pro_multi_list_res[[5]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-five.rds")

#Prokaryotic rare ASVs scenario six
saveRDS(pro_multi_list_res[[6]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-six.rds")
#Prokaryotic abundant ASVs scenario six
saveRDS(pro_multi_list_res[[6]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-six.rds")
#Prokaryotic intermediate ASVs scenario six
saveRDS(pro_multi_list_res[[6]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-six.rds")

#Prokaryotic rare ASVs scenario seven
saveRDS(pro_multi_list_res[[7]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-seven.rds")
#Prokaryotic abundant ASVs scenario seven
saveRDS(pro_multi_list_res[[7]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-seven.rds")
#Prokaryotic intermediate ASVs scenario seven
saveRDS(pro_multi_list_res[[7]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-seven.rds")

#Prokaryotic rare ASVs scenario eight
saveRDS(pro_multi_list_res[[8]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-eight.rds")
#Prokaryotic abundant ASVs scenario eight
saveRDS(pro_multi_list_res[[8]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-eight.rds")
#Prokaryotic intermediate ASVs scenario eight
saveRDS(pro_multi_list_res[[8]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-eight.rds")

#Prokaryotic rare ASVs scenario nine
saveRDS(pro_multi_list_res[[9]][[1]], "../results/16S/phylo-objects/16S-regional-rare-scenario-nine.rds")
#Prokaryotic abundant ASVs scenario nine
saveRDS(pro_multi_list_res[[9]][[2]], "../results/16S/phylo-objects/16S-regional-abundant-scenario-nine.rds")
#Prokaryotic intermediate ASVs scenario nine
saveRDS(pro_multi_list_res[[9]][[3]], "../results/16S/phylo-objects/16S-regional-intermediate-scenario-nine.rds")

#Eukaryotic rare ASVs scenario one
saveRDS(euk_multi_list_res[[1]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-one.rds")
#Eukaryotic abundant ASVs scenario one
saveRDS(euk_multi_list_res[[1]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-one.rds")
#Eukaryotic intermediate ASVs scenario one
saveRDS(euk_multi_list_res[[1]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-one.rds")

#Eukaryotic rare ASVs scenario two
saveRDS(euk_multi_list_res[[2]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-two.rds")
#Eukaryotic abundant ASVs scenario two
saveRDS(euk_multi_list_res[[2]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-two.rds")
#Eukaryotic intermediate ASVs scenario two
saveRDS(euk_multi_list_res[[2]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-two.rds")

#Eukaryotic rare ASVs scenario three
saveRDS(euk_multi_list_res[[3]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-three.rds")
#Eukaryotic abundant ASVs scenario three
saveRDS(euk_multi_list_res[[3]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-thee.rds")
#Eukaryotic intermediate ASVs scenario three
saveRDS(euk_multi_list_res[[3]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-three.rds")

#Eukaryotic rare ASVs scenario four
saveRDS(euk_multi_list_res[[4]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-four.rds")
#Eukaryotic abundant ASVs scenario four
saveRDS(euk_multi_list_res[[4]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-four.rds")
#Eukaryotic intermediate ASVs scenario four
saveRDS(euk_multi_list_res[[4]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-four.rds")

#Eukaryotic rare ASVs scenario five
saveRDS(euk_multi_list_res[[5]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-five.rds")
#Eukaryotic abundant ASVs scenario five
saveRDS(euk_multi_list_res[[5]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-five.rds")
#Eukaryotic intermediate ASVs scenario five
saveRDS(euk_multi_list_res[[5]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-five.rds")

#Eukaryotic rare ASVs scenario six
saveRDS(euk_multi_list_res[[6]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-six.rds")
#Eukaryotic abundant ASVs scenario six
saveRDS(euk_multi_list_res[[6]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-six.rds")
#Eukaryotic intermediate ASVs scenario six
saveRDS(euk_multi_list_res[[6]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-six.rds")

#Eukaryotic rare ASVs scenario seven
saveRDS(euk_multi_list_res[[7]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-seven.rds")
#Eukaryotic abundant ASVs scenario seven
saveRDS(euk_multi_list_res[[7]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-seven.rds")
#Eukaryotic intermediate ASVs scenario seven
saveRDS(euk_multi_list_res[[7]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-seven.rds")

#Eukaryotic rare ASVs scenario eight
saveRDS(euk_multi_list_res[[8]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-eight.rds")
#Eukaryotic abundant ASVs scenario eight
saveRDS(euk_multi_list_res[[8]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-eight.rds")
#Eukaryotic intermediate ASVs scenario eight
saveRDS(euk_multi_list_res[[8]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-eight.rds")

#Eukaryotic rare ASVs scenario nine
saveRDS(euk_multi_list_res[[9]][[1]], "../results/18S/phylo-objects/18S-regional-rare-scenario-nine.rds")
#Eukaryotic abundant ASVs scenario nine
saveRDS(euk_multi_list_res[[9]][[2]], "../results/18S/phylo-objects/18S-regional-abundant-scenario-nine.rds")
#Eukaryotic intermediate ASVs scenario nine
saveRDS(euk_multi_list_res[[9]][[3]], "../results/18S/phylo-objects/18S-regional-intermediate-scenario-nine.rds")
```