#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 7, heights = c(0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
#titles
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.9, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.2, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.55, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.85, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=10))+
guides(color = guide_legend(override.aes = list(size = 10, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 7, heights = c(0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=15))+
guides(color = guide_legend(override.aes = list(size = 8, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.9, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.2, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.55, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.85, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 7, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
null.p2 = null.p + theme(legend.text = element_text(size=10), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
final_data.edit[final_data.edit$Group == "Eukaryote"] <- "Microbial Eukaryote"
final_data.edit$Group[final_data.edit$Group == "Eukaryote"] <- "Microbial Eukaryote"
#load null model results
#bnti
pro.bnti = read.csv("../results/16S-bNTI-results-table.csv")
euk.bnti = read.csv("../results/18S-bNTI-results-table.csv")
#bind together
full.bNTI.df = rbind(pro.bnti, euk.bnti)
#export full table
write.csv(full.bNTI.df, "../results/full-bNTI-results-table.csv")
#rcbray results
pro.rcbray = read.csv("../results/16S-RCbray-results-table.csv")
euk.rcbray = read.csv("../results/18S-RCbray-results-table.csv")
#bind together
full.rcbray.df = rbind(pro.rcbray, euk.rcbray)
#export full table
write.csv(full.rcbray.df, "../results/full-RCbray-results-table.csv")
#GET RESULTS READY FOR PLOTTING
#create dataframes
#make sure everything is formatted correctly for merging
RC_bray <- full.rcbray.df
colnames(RC_bray) <- c("X", "Sample_2", "Sample_1", "RCb", "Group", "Habitat")
turnover.df = inner_join(full.bNTI.df, RC_bray)
turnover.df = turnover.df %>%
mutate(process = ifelse(abs(bNTI) < 2, #if absolute value of BNTI is less than 2
ifelse(abs(RCb) < 0.95, "Drift", #and absolute value of RCb is less than 0.95 = Drift
ifelse(RCb >= 0.95, "Dispersal Limited", #if RCb is > 0.95 = Dispersal limited
ifelse(RCb <= -0.95, "Homogenizing Dispersal", "ERROR"))), #< -0.95 = homo disp
ifelse(bNTI >= 2, "Variable Selection", #more than 2 = variable selection
ifelse(bNTI <= -2, "Homogeneous Selection", "ERROR")))) #< -2 = homogenous selection
turnover.df$process = factor(turnover.df$process, levels = c("Drift",
"Dispersal Limited", "Homogenizing Dispersal",
"Variable Selection", "Homogeneous Selection"))
#for each habitat
#find the number of number of site pairs
#and the percentage of those pairs that shows that process
hab.list <- unique(turnover.df$Habitat)
#Prokaryotes
pro_final_data <- data.frame(process=character(), n_sites=integer(), perc=numeric(), Habitat=character())
new.df <- subset(turnover.df, Group == "Prokaryote")
for (i in 1:length(hab.list)){
x <- new.df[new.df$Habitat == hab.list[i], ]
x <- x %>%
group_by(process) %>%
dplyr::summarize(n_sites = n(),
perc=(n()/nrow(x))*100) %>%
as.data.frame
x$Habitat<- hab.list[i]
pro_final_data <- rbind(pro_final_data, x)
}
pro_final_data$Group = "Prokaryote"
#Eukaryotes
euk_final_data <- data.frame(process=character(), n_sites=integer(), perc=numeric(), Habitat=character())
new.df <- subset(turnover.df, Group == "Eukaryote")
for (i in 1:length(hab.list)){
x <- new.df[new.df$Habitat == hab.list[i], ]
x <- x %>%
group_by(process) %>%
dplyr::summarize(n_sites = n(),
perc=(n()/nrow(x))*100) %>%
as.data.frame
x$Habitat<- hab.list[i]
euk_final_data <- rbind(euk_final_data, x)
}
euk_final_data$Group = "Eukaryote"
#bind results together
final_data = rbind(pro_final_data, euk_final_data) #, mm_final_data)
#add percentages column
final_data.edit <- final_data %>% dplyr::group_by(Habitat, Group) %>%
dplyr::mutate(frac = n_sites / sum(n_sites))
final_data.edit$frac = round(final_data.edit$frac,2)
#remove rows with zero perc
final_data.edit = final_data.edit[final_data.edit$frac >0,]
#save dataframe
write.csv(final_data.edit, "../results/null-model-results.csv")
#PLOT RESULTS
# final_data.edit = final_data.edit[final_data.edit$Group != "Micrometazoan",]
#make sure everything is in the right order
final_data.edit$Group[final_data.edit$Group == "Eukaryote"] <- "Microbial Eukaryote"
final_data.edit$Group = factor(final_data.edit$Group,
levels = c("Prokaryote", "Microbial Eukaryote"))
final_data.edit$Habitat = factor(final_data.edit$Habitat,
levels = c("Snow", "Spring Ice", "Summer Ice", "Cryoconite"))
null.p = ggplot(final_data.edit, aes(x = Habitat,y = n_sites,
fill = factor(process, levels=c("Homogeneous Selection", "Variable Selection", "Homogenizing Dispersal", "Dispersal Limited", "Drift")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(labels=scales::percent)+
geom_text(
aes(label = percent(frac)), position = position_fill(0.5), size=6) +
facet_grid(~ Group)+
theme_bw()+
ylab("Relative Contribution %")+
theme(text=element_text(size=15), legend.position = "bottom",
legend.title = element_blank(), axis.title.x=element_blank(),
axis.text=element_text(size=15), legend.text = element_text(size=15), strip.text.x = element_text(size = 10))+
guides(fill=guide_legend(nrow=1,byrow=TRUE))+
scale_fill_manual(values=c("#f8c4be","#f18579", "#c1e8ea", "#88d2d6","#4fbcc2"))
print(null.p)
pdf("../results/null-model.pdf", height = 10, width = 12)
print(null.p)
dev.off()
####put the plots together
#titles
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.9, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.2, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.55, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.85, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 7, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
null.p = ggplot(final_data.edit, aes(x = Habitat,y = n_sites,
fill = factor(process, levels=c("Homogeneous Selection", "Variable Selection", "Homogenizing Dispersal", "Dispersal Limited", "Drift")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(labels=scales::percent)+
geom_text(
aes(label = percent(frac)), position = position_fill(0.5), size=5) +
facet_grid(~ Group)+
theme_bw()+
ylab("Relative Contribution %")+
theme(text=element_text(size=15), legend.position = "bottom",
legend.title = element_blank(), axis.title.x=element_blank(),
axis.text=element_text(size=15), legend.text = element_text(size=15), strip.text.x = element_text(size = 10))+
guides(fill=guide_legend(nrow=1,byrow=TRUE))+
scale_fill_manual(values=c("#f8c4be","#f18579", "#c1e8ea", "#88d2d6","#4fbcc2"))
print(null.p)
pdf("../results/null-model.pdf", height = 10, width = 12)
print(null.p)
dev.off()
####put the plots together
#titles
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.9, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.2, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.55, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.85, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 7, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
null.p = ggplot(final_data.edit, aes(x = Habitat,y = n_sites,
fill = factor(process, levels=c("Homogeneous Selection", "Variable Selection", "Homogenizing Dispersal", "Dispersal Limited", "Drift")))) +
geom_bar(stat = "identity", position = "fill") +
scale_y_continuous(labels=scales::percent)+
geom_text(
aes(label = percent(frac)), position = position_fill(0.5), size=5) +
facet_grid(~ Group)+
theme_bw()+
ylab("Relative Contribution %")+
theme(text=element_text(size=15), legend.position = "bottom",
legend.title = element_blank(), axis.title.x=element_blank(),
axis.text=element_text(size=15), legend.text = element_text(size=15), strip.text.x = element_text(size = 15))+
guides(fill=guide_legend(nrow=2,byrow=TRUE))+
scale_fill_manual(values=c("#f8c4be","#f18579", "#c1e8ea", "#88d2d6","#4fbcc2"))
print(null.p)
pdf("../results/null-model.pdf", height = 10, width = 12)
print(null.p)
dev.off()
####put the plots together
#titles
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.9, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.2, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.55, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.85, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 7, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
#titles
title1 <- ggdraw() + draw_label("Neutral Model", hjust = 0.95, size=20, fontface = "bold")
title2 <- ggdraw() + draw_label("Null Model", hjust = 1.25, size=20, fontface = "bold")
pro.title <- ggdraw() + draw_label("Prokaryote", hjust = 1.6, size=15, fontface = "bold")
euk.title <- ggdraw() + draw_label("Microbial Eukaryote", hjust = 0.9, size=15, fontface = "bold")
#edit the legend
leg2add <- get_legend(p1 + theme(legend.position = "bottom",
legend.title = element_blank(),
legend.text = element_text(size=12))+
guides(color = guide_legend(override.aes = list(size = 7, alpha=1))))
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p2p2 = p2p
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p4p2 = p4p
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10))
p6p2 = p6p
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10))
null.p2 = null.p + theme(legend.text = element_text(size=10), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
null.p2 = null.p + theme(legend.text = element_text(size=15), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
null.p2 = null.p + theme(legend.text = element_text(size=13), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
#edit the axis of the plots
p1p2 = p1p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10), plot.title = element_text(size=15))
p2p2 = p2p+theme(plot.title = element_text(size=15))
p3p2 = p3p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10), plot.title = element_text(size=15))
p4p2 = p4p+theme(plot.title = element_text(size=15))
p5p2 = p5p+theme(axis.title.y=element_text(size=10), axis.text.y = element_text(size=10), plot.title = element_text(size=15))
p6p2 = p6p+theme(plot.title = element_text(size=15))
p7p2 = p7p+theme(axis.title=element_text(size=10), axis.text.y = element_text(size=10), plot.title = element_text(size=15))
p8p2 = p8p+theme(axis.title.x=element_text(size=10), axis.text.x = element_text(size=10), plot.title = element_text(size=15))
null.p2 = null.p + theme(legend.text = element_text(size=13), axis.text=element_text(size=10), axis.title.y = element_text(size=10))
#put everything together
p_indiv <- wrap_plots(title1+plot_spacer()+plot_spacer()+plot_spacer()+pro.title+plot_spacer()+p1p2+p2p2+p3p2+p4p2+euk.title+plot_spacer()+p5p2+p6p2+p7p2+p8p2+ plot_layout(nrow = 8, heights = c(0.1,0.1,0.1,1,1,0.1,1,1)))
combi.p <- (p_indiv/leg2add/(title2+plot_spacer())/null.p2) + plot_layout(nrow = 4, heights = c(1.2,0.1,0.05,0.5))
combi.p
pdf("../results/neutral-null-model.pdf", height = 15, width = 8)
print(combi.p)
dev.off()
# 1. Clear workspace and load packages
rm(list=ls())
graphics.off()
library(phyloseq)
library(ggplot2)
library(vegan) #for vegdist
library(dplyr) #for %>% function
library(ecodist) #for distance() function
library(parallel)
library(svglite)
#Load data
man.pro = read.csv("../results/prokaryote-mantel-results.csv")
man.euk = read.csv("../results/eukaryote-mantel-results.csv")
man.mm = read.csv("../results/microfauna-mantel-results.csv")
plot.df = rbind(man.euk, man.mm, man.pro)
#make sure our data has the right labels
plot.df$Group[plot.df$Group == "Micrometazoan"] <- "Microfauna"
plot.df$Group[plot.df$Group == "Eukaryote"] <- "Microbial Eukaryote"
View(plot.df)
#make sure our data are in the right order
plot.df$Group = factor(plot.df$Group,
levels = c("Prokaryote", "Microbial Eukaryote", "Microfauna"))
plot.df$Habitat = factor(plot.df$Habitat,
levels = c("Snow", "Spring Ice", "Summer Ice", "Cryoconite"))
p = ggplot(data=plot.df, aes(x=class.index, y=Mantel.cor)) +
geom_point(data=plot.df[plot.df$sig=="significant",], aes(x=class.index, y=Mantel.cor), color = "black", size=3, shape=16)+
geom_point(data=plot.df[plot.df$sig=="non-significant",], aes(x=class.index, y=Mantel.cor), color = "black",size=3, shape=1)+
geom_line()+
geom_hline(yintercept = 0, linetype=2)+
labs(x = "Phylogenetic distance class", y="Mantel correlation")+
# ylim(-0.03, 0.2)+
theme_bw()+
theme(axis.text = element_text(size=7),
axis.text.x = element_text(angle=45, hjust=1),
axis.title = element_text(size=7),
legend.position = "bottom")+
facet_wrap(~ Group + Habitat, scales="free", ncol=2)
p
pdf("../results/mantel-correlogram.pdf", height=15, width=10)
print(p)
dev.off()
# 1. Clear workspace and load packages
rm(list=ls())
graphics.off()
library(phyloseq)
library(ggplot2)
library(vegan) #for vegdist
library(dplyr) #for %>% function
library(ecodist) #for distance() function
library(parallel)
library(svglite)
#Load data
man.pro = read.csv("../results/prokaryote-mantel-results.csv")
man.euk = read.csv("../results/eukaryote-mantel-results.csv")
man.mm = read.csv("../results/microfauna-mantel-results.csv")
plot.df = rbind(man.euk, man.mm, man.pro)
#make sure our data has the right labels
plot.df$Group[plot.df$Group == "Micrometazoan"] <- "Microfauna"
plot.df$Group[plot.df$Group == "Eukaryote"] <- "Microbial Eukaryote"
#make sure our data are in the right order
plot.df$Group = factor(plot.df$Group,
levels = c("Prokaryote", "Microbial Eukaryote", "Microfauna"))
plot.df$Habitat = factor(plot.df$Habitat,
levels = c("Snow", "Spring Ice", "Summer Ice", "Cryoconite"))
p = ggplot(data=plot.df, aes(x=class.index, y=Mantel.cor)) +
geom_point(data=plot.df[plot.df$sig=="significant",], aes(x=class.index, y=Mantel.cor), color = "black", size=3, shape=16)+
geom_point(data=plot.df[plot.df$sig=="non-significant",], aes(x=class.index, y=Mantel.cor), color = "black",size=3, shape=1)+
geom_line()+
geom_hline(yintercept = 0, linetype=2)+
labs(x = "Phylogenetic distance class", y="Mantel correlation")+
# ylim(-0.03, 0.2)+
theme_bw()+
theme(axis.text = element_text(size=10),
axis.text.x = element_text(angle=45, hjust=1),
axis.title = element_text(size=10),
legend.position = "bottom")+
facet_wrap(~ Group + Habitat, scales="free", ncol=2)
p
pdf("../results/mantel-correlogram.pdf", height=15, width=10)
print(p)
dev.off()
# 1. Clear workspace and load packages
rm(list=ls())
graphics.off()
library(phyloseq)
library(ggplot2)
library(vegan) #for vegdist
library(dplyr) #for %>% function
library(ecodist) #for distance() function
library(parallel)
library(svglite)
#Load data
man.pro = read.csv("../results/prokaryote-mantel-results.csv")
man.euk = read.csv("../results/eukaryote-mantel-results.csv")
man.mm = read.csv("../results/microfauna-mantel-results.csv")
plot.df = rbind(man.euk, man.mm, man.pro)
#make sure our data has the right labels
plot.df$Group[plot.df$Group == "Micrometazoan"] <- "Microfauna"
plot.df$Group[plot.df$Group == "Eukaryote"] <- "Microbial Eukaryote"
#make sure our data are in the right order
plot.df$Group = factor(plot.df$Group,
levels = c("Prokaryote", "Microbial Eukaryote", "Microfauna"))
plot.df$Habitat = factor(plot.df$Habitat,
levels = c("Snow", "Spring Ice", "Summer Ice", "Cryoconite"))
p = ggplot(data=plot.df, aes(x=class.index, y=Mantel.cor)) +
geom_point(data=plot.df[plot.df$sig=="significant",], aes(x=class.index, y=Mantel.cor), color = "black", size=3, shape=16)+
geom_point(data=plot.df[plot.df$sig=="non-significant",], aes(x=class.index, y=Mantel.cor), color = "black",size=3, shape=1)+
geom_line()+
geom_hline(yintercept = 0, linetype=2)+
labs(x = "Phylogenetic distance class", y="Mantel correlation")+
# ylim(-0.03, 0.2)+
theme_bw()+
theme(axis.text = element_text(size=13),
axis.text.x = element_text(angle=45, hjust=1),
axis.title = element_text(size=13),
legend.position = "bottom")+
facet_wrap(~ Group + Habitat, scales="free", ncol=2)
p
pdf("../results/mantel-correlogram.pdf", height=15, width=10)
print(p)
dev.off()
# 1. Clear workspace and load packages
rm(list=ls())
graphics.off()
library(phyloseq)
library(ggplot2)
library(vegan) #for vegdist
library(dplyr) #for %>% function
library(scales) #for percentages
library(picante) #for faith's pd and comdistnt functions
library(ecodist) #for distance() function
library(parallel)
library(svglite)
#import data
ps.pro <- readRDS("../results/16S-phylo-object.rds")
